---
layout: default
title: 
---
<h1 id="単体の幾何学的モーメントの計算">単体の幾何学的モーメントの計算</h1>
<p>二次元平面上の3点<span class="math inline">\(P=(x_0,y_0) , Q=(x_1,y_1) , R=(x_2 , y_2)\)</span>を頂点とする三角形を<span class="math inline">\(S\)</span>とする <span class="math display">\[S = \{ ((1-u-v)x_0 + u x_1 + vx_2,(1-u-v)y_0 + u y_1 + v y_2) \in \mathbf{R}^2 | 0 \leq u,v,u+v \leq 1 \}\]</span> <span class="math display">\[S_0 = \{(u,v) \in \mathbf{R}^2 |  0 \leq u,v,u+v \leq 1 \}\]</span></p>
<p>この時、以下の量を計算する <span class="math display">\[M_{ij} = \displaystyle \int_S x^i y^j dx dy\]</span> <span class="math inline">\(i=j=0\)</span>の時は、面積で <span class="math display">\[M_{00} = \displaystyle \int_{S_0} \left(\displaystyle \frac{\partial x}{\partial u}\displaystyle \frac{\partial y}{\partial v} - \displaystyle \frac{\partial x}{\partial v}\displaystyle \frac{\partial y}{\partial u} \right)dudv = \displaystyle \int_{S_0} \left( (x_1-x_0)(y_2-y_0) - (x_2-x_0)(y_1-y_0) \right)dudv \]</span> <span class="math display">\[ = \displaystyle \frac{1}{2} \left( (x_1-x_0)(y_2-y_0) - (x_2-x_0)(y_1-y_0)  \right)\]</span></p>
<p>以下、ヤコビアン<span class="math inline">\(J= (x_1-x_0)(y_2-y_0) - (x_2-x_0)(y_1-y_0)\)</span>を定めておくと同様に <span class="math display">\[M_{10} = \displaystyle \int_{S_0} \left( (1-u-v)x_0 + u x_1 + vx_2 \right) \left( \displaystyle \frac{\partial x}{\partial u}\displaystyle \frac{\partial y}{\partial v} - \displaystyle \frac{\partial x}{\partial v}\displaystyle \frac{\partial y}{\partial u} \right)dudv\]</span> <span class="math display">\[= J \displaystyle \int_{0}^{1} du \int_{0}^{1-u} dv \left( (1-u-v)x_0 + u x_1 + vx_2\right) = 
J \displaystyle \int_{0}^{1} du \left( (1-u) x_0 + u(1-u)(x_1-x_0)+ \displaystyle \frac{1}{2}(1-u)^2 (x_2-x_0) \right)\]</span> <span class="math display">\[= \displaystyle \frac{J}{6} (x_0 + x_1 + x_2)\]</span> を得る</p>
<p>Stokesの定理によって、境界線上の積分に置き換えることもできる。再び、<span class="math inline">\(i=j=0\)</span>の時を考えると <span class="math display">\[M_{00} = \displaystyle \int_S dx dy = \displaystyle \int_{\overline{PQ}} x dy + \displaystyle \int_{\overline{QR}} x dy + \displaystyle \int_{\overline{RP}} x dy\]</span> で、例えば<span class="math inline">\(x(t)=x_0+t(x_1-x_0) , y(t)=y_0+t(y_1-y_0)\)</span>として <span class="math display">\[\displaystyle \int_{\overline{PQ}} x dy = \displaystyle \int_{0}^{1} x(t) \displaystyle \frac{dy}{dt}dt = x_0(y_1-y_0) + \displaystyle \frac{1}{2} (x_1 - x_0)(y_1 - y_0)\]</span> を得る。同様に <span class="math display">\[\displaystyle \int_{\overline{QR}} x dy = x_1(y_2-y_1) + \displaystyle \frac{1}{2} (x_2 - x_1)(y_2 - y_1)\]</span> <span class="math display">\[\displaystyle \int_{\overline{RP}} x dy = x_2(y_0-y_2) + \displaystyle \frac{1}{2} (x_0 - x_2)(y_0 - y_2)\]</span> から <span class="math display">\[M_{00} = \displaystyle \frac{1}{2} \left( (x_1-x_0)(y_2-y_0) - (x_2-x_0)(y_1-y_0)  \right)\]</span> 一般には <span class="math display">\[M_{ij} = \displaystyle \frac{1}{i} \displaystyle \int_{\partial S} x^{i+1} y^j dy\]</span> なので、機械的に計算すればいい</p>
<p>三次元の場合に、同様のことを考える。四面体<span class="math inline">\(V\)</span>の4頂点を<span class="math inline">\(P_0=(x_0,y_0) , P_1=(x_1,y_1) , P_2=(x_2 , y_2) , P_3=(x_3,y_3)\)</span>として以下の量を計算する <span class="math display">\[M_{ijk} = \displaystyle \int_V x^i y^j z^k dx dy dz\]</span> Stokesの定理によって、境界上の積分に置き換えることができる <span class="math display">\[\displaystyle \int_{\triangle{P_0 P_1 P_2}} x dy dz = \displaystyle \int_{0}^{1} du \int_{0}^{1-u} dv \left( (1-u-v)x_0 + u x_1 + vx_2\right) \left[ (y_1 - y_0)(z_2 - z_0) - (y_2 - y_0)(z_1 - z_0) \right]\]</span> <span class="math display">\[=  \left[ (y_1 - y_0)(z_2 - z_0) - (y_2 - y_0)(z_1 - z_0) \right] \displaystyle \int_{0}^{1} du \left( x_0(1-u) + \displaystyle \frac{1}{2} u(1-u)(x_1-x_0) + \displaystyle \frac{1}{2}(1-u)^2 (x_2 - x_0) \right)\]</span> <span class="math display">\[= \displaystyle \frac{x_0+x_1+x_2}{6} \left[ (y_1 - y_0)(z_2 - z_0) - (y_2 - y_0)(z_1 - z_0) \right]\]</span></p>
<p>面の向きを考慮すると <span class="math display">\[M_{000} = -\displaystyle \int_{\triangle{P_0 P_1 P_2}} x dy dz + \displaystyle \int_{\triangle{P_1 P_2 P_3}} x dy dz -\displaystyle \int_{\triangle{P_2 P_3 P_0}} x dy dz + \displaystyle \int_{\triangle{P_3 P_0 P_1}} x dy dz\]</span> で、頑張って多項式の足し算を行うと <span class="math display">\[M_{000} = \displaystyle \frac{1}{6} \left| \begin{matrix} x_1 - x_0 &amp; x_2 - x_0 &amp; x_3 - x_0 \\ y_1 - y_0 &amp; y_2-y_0 &amp; y_3-y_0 \\ z_1-z_0 &amp; z_2 -z_0 &amp; z_3 -z_0 \end{matrix} \right|\]</span> というよく知られた公式を得る</p>
<p>以下、同様の計算であるので、sympyを使って、いくつか計算した結果を掲載しておく</p>
<p><span class="math display">\[M_{100} = \frac{1}{4} \left(x_{0} + x_{1} + x_{2} + x_{3}\right) M_{000}\]</span></p>
<p><span class="math display">\[M_{200} = \frac{1}{10} \left(x_{0}^{2} + x_{0} x_{1} + x_{0} x_{2} + x_{0} x_{3} + x_{1}^{2} + x_{1} x_{2} + x_{1} x_{3} + x_{2}^{2} + x_{2} x_{3} + x_{3}^{2}\right) M_{000}\]</span></p>
<p><span class="math display">\[M_{110} = \frac{1}{20} \left(2 x_{0} y_{0} + x_{0} y_{1} + x_{0} y_{2} + x_{0} y_{3} + x_{1} y_{0} + 2 x_{1} y_{1} + x_{1} y_{2} + x_{1} y_{3} + x_{2} y_{0} + x_{2} y_{1} + 2 x_{2} y_{2} + x_{2} y_{3} + x_{3} y_{0} + x_{3} y_{1} + x_{3} y_{2} + 2 x_{3} y_{3}\right) M_{000}\]</span></p>
<p><span class="math display">\[M_{300} = \frac{1}{20} \left(x_{0}^{3} + x_{0}^{2} x_{1} + x_{0}^{2} x_{2} + x_{0}^{2} x_{3} + x_{0} x_{1}^{2} + x_{0} x_{1} x_{2} + x_{0} x_{1} x_{3} + x_{0} x_{2}^{2} + x_{0} x_{2} x_{3} + x_{0} x_{3}^{2} + x_{1}^{3} + x_{1}^{2} x_{2} + x_{1}^{2} x_{3} + x_{1} x_{2}^{2} + x_{1} x_{2} x_{3} + x_{1} x_{3}^{2} + x_{2}^{3} + x_{2}^{2} x_{3} + x_{2} x_{3}^{2} + x_{3}^{3}\right) M_{000}\]</span></p>
<p><span class="math display">\[M_{210} = \frac{1}{60} \left(3 x_{0}^{2} y_{0} + x_{0}^{2} y_{1} + x_{0}^{2} y_{2} + x_{0}^{2} y_{3} + 2 x_{0} x_{1} y_{0} + 2 x_{0} x_{1} y_{1} + x_{0} x_{1} y_{2} + x_{0} x_{1} y_{3} + 2 x_{0} x_{2} y_{0} + x_{0} x_{2} y_{1} + 2 x_{0} x_{2} y_{2} + x_{0} x_{2} y_{3} + 2 x_{0} x_{3} y_{0} + x_{0} x_{3} y_{1} + x_{0} x_{3} y_{2} + 2 x_{0} x_{3} y_{3} + x_{1}^{2} y_{0} + 3 x_{1}^{2} y_{1} + x_{1}^{2} y_{2} + x_{1}^{2} y_{3} + x_{1} x_{2} y_{0} + 2 x_{1} x_{2} y_{1} + 2 x_{1} x_{2} y_{2} + x_{1} x_{2} y_{3} + x_{1} x_{3} y_{0} + 2 x_{1} x_{3} y_{1} + x_{1} x_{3} y_{2} + 2 x_{1} x_{3} y_{3} + x_{2}^{2} y_{0} + x_{2}^{2} y_{1} + 3 x_{2}^{2} y_{2} + x_{2}^{2} y_{3} + x_{2} x_{3} y_{0} + x_{2} x_{3} y_{1} + 2 x_{2} x_{3} y_{2} + 2 x_{2} x_{3} y_{3} + x_{3}^{2} y_{0} + x_{3}^{2} y_{1} + x_{3}^{2} y_{2} + 3 x_{3}^{2} y_{3}\right) M_{000}\]</span></p>
<p><span class="math display">\[M_{111} = \frac{1}{120} \left(6 x_{0} y_{0} z_{0} + 2 x_{0} y_{0} z_{1} + 2 x_{0} y_{0} z_{2} + 2 x_{0} y_{0} z_{3} + 2 x_{0} y_{1} z_{0} + 2 x_{0} y_{1} z_{1} + x_{0} y_{1} z_{2} + x_{0} y_{1} z_{3} + 2 x_{0} y_{2} z_{0} + x_{0} y_{2} z_{1} + 2 x_{0} y_{2} z_{2} + x_{0} y_{2} z_{3} + 2 x_{0} y_{3} z_{0} + x_{0} y_{3} z_{1} + x_{0} y_{3} z_{2} + 2 x_{0} y_{3} z_{3} + 2 x_{1} y_{0} z_{0} + 2 x_{1} y_{0} z_{1} + x_{1} y_{0} z_{2} + x_{1} y_{0} z_{3} + 2 x_{1} y_{1} z_{0} + 6 x_{1} y_{1} z_{1} + 2 x_{1} y_{1} z_{2} + 2 x_{1} y_{1} z_{3} + x_{1} y_{2} z_{0} + 2 x_{1} y_{2} z_{1} + 2 x_{1} y_{2} z_{2} + x_{1} y_{2} z_{3} + x_{1} y_{3} z_{0} + 2 x_{1} y_{3} z_{1} + x_{1} y_{3} z_{2} + 2 x_{1} y_{3} z_{3} + 2 x_{2} y_{0} z_{0} + x_{2} y_{0} z_{1} + 2 x_{2} y_{0} z_{2} + x_{2} y_{0} z_{3} + x_{2} y_{1} z_{0} + 2 x_{2} y_{1} z_{1} + 2 x_{2} y_{1} z_{2} + x_{2} y_{1} z_{3} + 2 x_{2} y_{2} z_{0} + 2 x_{2} y_{2} z_{1} + 6 x_{2} y_{2} z_{2} + 2 x_{2} y_{2} z_{3} + x_{2} y_{3} z_{0} + x_{2} y_{3} z_{1} + 2 x_{2} y_{3} z_{2} + 2 x_{2} y_{3} z_{3} + 2 x_{3} y_{0} z_{0} + x_{3} y_{0} z_{1} + x_{3} y_{0} z_{2} + 2 x_{3} y_{0} z_{3} + x_{3} y_{1} z_{0} + 2 x_{3} y_{1} z_{1} + x_{3} y_{1} z_{2} + 2 x_{3} y_{1} z_{3} + x_{3} y_{2} z_{0} + x_{3} y_{2} z_{1} + 2 x_{3} y_{2} z_{2} + 2 x_{3} y_{2} z_{3} + 2 x_{3} y_{3} z_{0} + 2 x_{3} y_{3} z_{1} + 2 x_{3} y_{3} z_{2} + 6 x_{3} y_{3} z_{3}\right) M_{000}\]</span></p>
<pre><code>import sympy
x0,y0,z0 = sympy.symbols(&quot;x0 y0 z0&quot;)
x1,y1,z1 = sympy.symbols(&quot;x1 y1 z1&quot;)
x2,y2,z2 = sympy.symbols(&quot;x2 y2 z2&quot;)
x3,y3,z3 = sympy.symbols(&quot;x3 y3 z3&quot;)


def m3(i,j,k):
   u,v = sympy.symbols(&quot;u v&quot;)
   J=(y1-y0)*(z2-z0)-(y2-y0)*(z1-z0)
   f = ( (x0 + u*(x1-x0) + v*(x2-x0))**(i+1)/(i+1) )*( (y0 + u*(y1-y0) + v*(y2-y0))**j )*( (z0 + u*(z1-z0) + v*(z2-z0))**k )
   g012 = sympy.integrate(sympy.integrate(f , (v,0,1-u)) , (u,0,1))*J
   g123 = g012.subs({x0:x1,x1:x2,x2:x3,y0:y1,y1:y2,y2:y3,z0:z1,z1:z2,z2:z3} , simultaneous=True)
   g230 = g123.subs({x1:x2,x2:x3,x3:x0,y1:y2,y2:y3,y3:y0,z1:z2,z2:z3,z3:z0} , simultaneous=True)
   g301 = g230.subs({x2:x3,x3:x0,x0:x1,y2:y3,y3:y0,y0:y1,z2:z3,z3:z0,z0:z1} , simultaneous=True)
   return sympy.factor(-g012+g123-g230+g301)


if __name__==&quot;__main__&quot;:
   print(sympy.latex( sympy.factor(m3(1,0,0)/m3(0,0,0)) ))
   print(sympy.latex( sympy.factor(m3(2,0,0)/m3(0,0,0)) ))
   print(sympy.latex( sympy.factor(m3(1,1,0)/m3(0,0,0)) ))
   print(sympy.latex( sympy.factor(m3(3,0,0)/m3(0,0,0)) ))
   print(sympy.latex( sympy.factor(m3(2,1,0)/m3(0,0,0)) ))
   print(sympy.latex( sympy.factor(m3(1,1,1)/m3(0,0,0)) ))

</code></pre>